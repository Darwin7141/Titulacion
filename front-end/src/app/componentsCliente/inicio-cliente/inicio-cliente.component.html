<mat-sidenav-container class="sidenav-container">

  <!-- ══════════════  LATERAL  ══════════════ -->
  <mat-sidenav #drawer mode="side" opened class="sidenav">
    <mat-nav-list>

      <!-- Servicios como acordeón con submenú -->
      <mat-list-item class="menu-item menu-principal"
                     (click)="showServicios = !showServicios"
                     [class.open]="showServicios">
        <mat-icon matListIcon>restaurant_menu</mat-icon>
        <span>Servicios</span>
        <mat-icon class="expand-icon">
          {{ showServicios ? 'expand_less' : 'expand_more' }}
        </mat-icon>
      </mat-list-item>

      <div class="submenu" [@slideToggle]="showServicios">
        
        <!-- Ver todos (tarjetas) 
        <a mat-list-item (click)="setView('servicios'); drawer.close()">
          <mat-icon matListIcon>view_module</mat-icon>
          <span>Todos</span>
        </a> -->

        <!-- Lista dinámica de servicios -->
        <a mat-list-item class="submenu-item"
          *ngFor="let s of serviciosSidebar"
           (click)="seleccionarServicio(s); drawer.close()">
          <mat-icon matListIcon>room_service</mat-icon>
          <span>{{ s.nombre }}</span>
        </a>
      </div>

      <a mat-list-item class="menu-item" (click)="setView('generar'); drawer.close()">
        <mat-icon matListIcon>event_available</mat-icon>
        <span>Agendar&nbsp;Reserva</span>
      </a>

      <a mat-list-item class="menu-item" (click)="setView('reservas'); drawer.close()">
        <mat-icon matListIcon>assignment</mat-icon>
        <span>Mis&nbsp;Reservas</span>
      </a>

    </mat-nav-list>
  </mat-sidenav>

  <!-- ══════════════  PRINCIPAL  ══════════════ -->
  <mat-sidenav-content>

    <!-- ───── Barra superior ───── -->
    <mat-toolbar color="primary" class="toolbar">

      <span class="app-title">DAAYFOOD</span>
      <button mat-icon-button
          class="edge-menu"
          (click)="drawer.toggle()"
          [style.left.px]="(drawer.opened ? sidenavWidth : sidenavWidth) "
          aria-label="Menú">
    <mat-icon>menu</mat-icon>
    </button>
      <span class="spacer"></span>

      <button mat-icon-button (click)="verNotificacionesCliente()">
        <mat-icon  [matBadge]="cantidadNotificacionesCliente"
                   matBadgeColor="warn"
                   [matBadgeHidden]="!hayNuevasNotificaciones">
          {{ hayNuevasNotificaciones ? 'notifications_active' : 'notifications' }}
        </mat-icon>
      </button>

      <button mat-icon-button (click)="logout()">
        <mat-icon>power_settings_new</mat-icon>
      </button>

      <button mat-button >
        <mat-icon>person</mat-icon>
        {{ usuarioNombre }}
      </button>
      
    </mat-toolbar>

    <!-- ══════════════════  ZONA CENTRAL  ══════════════════ -->
    <div class="content-wrapper">

      <!-- **********  SWITCH DE VISTAS  ********** -->
      <ng-container [ngSwitch]="activeView">

        <!-- ① DASHBOARD (portada con slider) -->
        <ng-container *ngSwitchCase="'dashboard'">

          <mat-card class="welcome-card">
            <h1>Nuestros&nbsp;Servicios</h1>
          </mat-card>
          <br>

          <mat-card class="slider-card" *ngIf="slides.length">

            <!-- flechas -->
            <button mat-icon-button class="nav prev" (click)="prev()">
              <mat-icon>chevron_left</mat-icon>
            </button>
            <button mat-icon-button class="nav next" (click)="next()">
              <mat-icon>chevron_right</mat-icon>
            </button>

            <!-- imágenes -->
            <ng-container *ngFor="let s of slides; let i = index">
              <div class="slide" [class.active]="i === currentSlide">
                <img [src]="s.url" alt="servicio {{ s.nombre }}" />
                <div class="caption">
                  <h2>{{ s.nombre }}</h2>
                  <p>{{ s.descripcion }}</p>
                </div>
              </div>
            </ng-container>

          </mat-card>

        </ng-container>

        <!-- ② LISTA DE SERVICIOS -->
        <ng-container *ngSwitchCase="'servicios'">
          <app-servicios-cliente
               (cerrar)="setView('dashboard')"></app-servicios-cliente>
        </ng-container>

        

        <!-- ③ FORMULARIO “AGENDAR RESERVA” -->
        <ng-container *ngSwitchCase="'generar'">
          <app-agendar-reserva
               (cerrar)="setView('dashboard')"></app-agendar-reserva>
        </ng-container>

        <!-- ④ HISTORIAL DE RESERVAS -->
        <ng-container *ngSwitchCase="'reservas'">
          <app-mis-reservas
               (cerrar)="setView('dashboard')"></app-mis-reservas>
        </ng-container>

        <!-- ⑤ MENÚS por servicio (nuevo) -->
        <ng-container *ngSwitchCase="'menus'">
  <app-menus-cliente
    *ngIf="selectedServicioId !== null"
    [idServicio]="selectedServicioId"
    [nombreServicio]="selectedServicioNombre"
    (cerrar)="setView('dashboard')"
    (irAReserva)="onIrAReserva()"
    >
  </app-menus-cliente>
</ng-container>

      </ng-container>
      <!-- **********  FIN SWITCH  ********** -->

    </div> <!-- /content-wrapper -->

  </mat-sidenav-content>
</mat-sidenav-container>
